{% extends "base.html" %}

{% block content %}
<h2 class="mb-4"><i class="fas fa-bell me-2"></i>Notifications</h2>

<div class="glass-card">
    <div id="notificationsList">
        <div class="text-center p-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    async function loadNotifications() {
        try {
            const response = await fetch('/api/get_notifications');
            const notifications = await response.json();

            const list = document.getElementById('notificationsList');
            if (notifications.length === 0) {
                list.innerHTML = '<div class="alert alert-info m-3">No notifications yet.</div>';
                return;
            }

            list.innerHTML = '';
            notifications.forEach(notif => {
                const item = document.createElement('div');
                item.className = 'p-3 border-bottom border-secondary';

                let icon = 'fa-info-circle';
                let color = 'text-info';

                if (notif.type === 'success') {
                    icon = 'fa-check-circle';
                    color = 'text-success';
                } else if (notif.type === 'warning') {
                    icon = 'fa-exclamation-triangle';
                    color = 'text-warning';
                } else if (notif.type === 'error') {
                    icon = 'fa-exclamation-circle';
                    color = 'text-danger';
                }

                item.innerHTML = `
                    <div class="d-flex align-items-center">
                        <i class="fas ${icon} ${color} fa-lg me-3"></i>
                        <div class="flex-grow-1">
                            <div class="d-flex justify-content-between">
                                <h6 class="mb-1">${notif.message}</h6>
                                <small class="text-muted">${notif.time}</small>
                            </div>
                        </div>
                    </div>
                `;
                list.appendChild(item);
            });
        } catch (e) {
            console.error('Error loading notifications:', e);
        }
    }

    loadNotifications();
</script>
{% endblock %}